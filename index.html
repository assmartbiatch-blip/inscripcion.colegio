<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liceo Los Andes ¬∑ Inscripciones 2025</title>
    <!-- jsPDF -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background-color: #FFF3E0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 900px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: #FF8A5C;
            font-size: 2.5rem;
            font-weight: 700;
            text-shadow: 2px 2px 0 #FFD1DC;
        }

        .header p {
            color: #4A4A4A;
            font-size: 1.2rem;
            background: rgba(255, 209, 220, 0.3);
            display: inline-block;
            padding: 5px 20px;
            border-radius: 50px;
            margin-top: 10px;
        }

        .card {
            background: white;
            border-radius: 40px;
            padding: 45px;
            box-shadow: 0 25px 45px rgba(255, 138, 92, 0.25);
            border: 2px solid #FFD1DC;
        }

        .step-indicator {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
            position: relative;
        }

        .step-indicator::before {
            content: '';
            position: absolute;
            top: 20px;
            left: 0;
            width: 100%;
            height: 3px;
            background: #E5C5A4;
            z-index: 1;
        }

        .step {
            background: #FFF3E0;
            border: 3px solid #FFD1DC;
            color: #4A4A4A;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.3rem;
            position: relative;
            z-index: 2;
        }

        .step.active {
            background: #FF8A5C;
            border-color: #FF8A5C;
            color: white;
            transform: scale(1.1);
            box-shadow: 0 0 0 4px #FFD1DC;
        }

        .step.completed {
            background: #FF8A5C;
            border-color: #FF8A5C;
            color: white;
        }

        .form-step {
            display: none;
            animation: fadeIn 0.5s;
        }

        .form-step.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateX(20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #4A4A4A;
            font-weight: 600;
        }

        input, select, textarea {
            width: 100%;
            padding: 14px 18px;
            border: 2px solid #E5C5A4;
            border-radius: 20px;
            font-size: 1rem;
            background: #FFF9F5;
            transition: 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #FF8A5C;
            box-shadow: 0 0 0 4px rgba(255, 138, 92, 0.2);
        }

        .row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .info-box {
            background: #FFD1DC40;
            border-left: 5px solid #FF8A5C;
            padding: 20px;
            border-radius: 20px;
            margin: 20px 0;
        }

        .btn {
            background: #FF8A5C;
            color: white;
            border: none;
            padding: 16px 35px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
            width: 100%;
            margin-top: 15px;
        }

        .btn:hover {
            background: #ff6b3d;
            transform: translateY(-3px);
            box-shadow: 0 10px 25px #FF8A5C80;
        }

        .btn-secondary {
            background: #E5C5A4;
            margin-top: 10px;
        }

        .btn-secondary:hover {
            background: #d6b392;
        }

        .btn-upload {
            background: #FFD1DC;
            color: #4A4A4A;
            border: 2px dashed #FF8A5C;
            padding: 20px;
            border-radius: 20px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
        }

        .btn-upload:hover {
            background: #FFD1DC;
            border-color: #ff6b3d;
        }

        .file-info {
            margin-top: 15px;
            padding: 12px;
            background: #FFF3E0;
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-info button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 50px;
            cursor: pointer;
        }

        .resumen-table {
            width: 100%;
            border-collapse: collapse;
            background: #FFF9F5;
            border-radius: 20px;
            overflow: hidden;
            margin: 25px 0;
        }

        .resumen-table th {
            background: #FF8A5C;
            color: white;
            padding: 12px;
            text-align: left;
        }

        .resumen-table td {
            padding: 12px;
            border-bottom: 1px solid #FFD1DC;
        }

        .badge {
            background: #FFD1DC;
            color: #4A4A4A;
            padding: 5px 15px;
            border-radius: 50px;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèõÔ∏è U.E. Colegio Los Andes</h1>
            <p>Inscripciones 2025 ¬∑ Verificaci√≥n + Pago</p>
        </div>

        <div class="card">
            <div class="step-indicator">
                <div class="step active" id="step1">1</div>
                <div class="step" id="step2">2</div>
                <div class="step" id="step3">3</div>
            </div>

            <!-- PASO 1: VERIFICACI√ìN -->
            <div id="step1-form" class="form-step active">
                <h2 style="color: #FF8A5C; margin-bottom: 20px;">üîç Verificar estudiante</h2>
                <p class="badge">Ingrese la c√©dula del estudiante</p>
                <div class="form-group">
                    <label for="cedula_estudiante">C√©dula (Ej: V-12345678)</label>
                    <input type="text" id="cedula_estudiante" placeholder="V-12345678" oninput="validarCedula()">
                </div>
                <div id="info-estudiante" class="info-box" style="display: none;"></div>
                <button class="btn" onclick="verificarEstudiante()">üîç Verificar</button>
                <button class="btn btn-secondary" id="btn-paso2" disabled onclick="irPaso2()">‚û°Ô∏è Continuar</button>
            </div>

            <!-- PASO 2: FORMULARIO -->
            <div id="step2-form" class="form-step">
                <h2 style="color: #FF8A5C; margin-bottom: 20px;">üìã Datos de inscripci√≥n</h2>
                <form id="form-inscripcion" onsubmit="event.preventDefault(); irPaso3()">
                    <div class="row">
                        <div class="form-group">
                            <label>Nombres</label>
                            <input type="text" id="nombres" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos</label>
                            <input type="text" id="apellidos" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group">
                            <label>Fecha nacimiento</label>
                            <input type="date" id="fecha_nacimiento" onchange="calcularEdad()" required>
                        </div>
                        <div class="form-group">
                            <label>Edad</label>
                            <input type="text" id="edad" readonly>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group">
                            <label>A√±o a cursar</label>
                            <select id="ano_cursar" required>
                                <option value="">Seleccione...</option>
                                <option value="1">1er a√±o</option>
                                <option value="2">2do a√±o</option>
                                <option value="3">3er a√±o</option>
                                <option value="4">4to a√±o</option>
                                <option value="5">5to a√±o</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Tipo ingreso</label>
                            <select id="tipo_ingreso">
                                <option value="nuevo">Nuevo</option>
                                <option value="regular">Regular</option>
                            </select>
                        </div>
                    </div>
                    <h3>üë™ Representante</h3>
                    <div class="row">
                        <div class="form-group">
                            <label>Nombres</label>
                            <input type="text" id="rep_nombres" required>
                        </div>
                        <div class="form-group">
                            <label>Apellidos</label>
                            <input type="text" id="rep_apellidos" required>
                        </div>
                    </div>
                    <div class="row">
                        <div class="form-group">
                            <label>C√©dula</label>
                            <input type="text" id="rep_cedula" placeholder="V-12345678" required>
                        </div>
                        <div class="form-group">
                            <label>Tel√©fono</label>
                            <input type="tel" id="rep_telefono" placeholder="0412-1234567" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Email</label>
                        <input type="email" id="rep_email" required>
                    </div>
                    <button type="submit" class="btn">üìã Continuar</button>
                </form>
            </div>

            <!-- PASO 3: CONFIRMACI√ìN + PAGO -->
            <div id="step3-form" class="form-step">
                <h2 style="color: #FF8A5C; margin-bottom: 20px;">üí∞ Confirmar y pagar</h2>

                <div id="resumen-contenido"></div>

                <h3 style="margin: 30px 0 15px;">üßæ Comprobante de pago</h3>
                <div class="btn-upload" onclick="document.getElementById('file-pago').click()">
                    üìé Haga clic para subir comprobante (PDF, JPG, PNG)
                </div>
                <input type="file" id="file-pago" accept=".pdf,.jpg,.jpeg,.png" style="display: none;" onchange="mostrarComprobante()">

                <div id="file-info-container"></div>

                <button class="btn" onclick="confirmarConPago()">‚úÖ Confirmar y generar PDF</button>
                <button class="btn btn-secondary" onclick="irPaso2()">‚¨ÖÔ∏è Editar datos</button>
            </div>
        </div>
    </div>

    <script>
        let estudianteVerificado = null;
        let archivoComprobante = null;

        function validarCedula() {
            const input = document.getElementById('cedula_estudiante');
            return /^[VE]-?\d{5,8}$/i.test(input.value);
        }

        function verificarEstudiante() {
            if (!validarCedula()) {
                alert('Formato de c√©dula inv√°lido');
                return;
            }
            const cedula = document.getElementById('cedula_estudiante').value;
            const db = {
                'V-12345678': { nombres: 'Mar√≠a', apellidos: 'Gonz√°lez', ano: '1', habilitado: true },
                'V-87654321': { nombres: 'Jos√©', apellidos: 'P√©rez', ano: '3', habilitado: true },
                'V-11223344': { nombres: 'Ana', apellidos: 'Flores', ano: '5', habilitado: false }
            };
            estudianteVerificado = db[cedula];
            const info = document.getElementById('info-estudiante');
            const btn = document.getElementById('btn-paso2');
            if (estudianteVerificado?.habilitado) {
                info.style.display = 'block';
                info.innerHTML = `‚úÖ HABILITADO: ${estudianteVerificado.nombres} ${estudianteVerificado.apellidos}`;
                btn.disabled = false;
                document.getElementById('nombres').value = estudianteVerificado.nombres || '';
                document.getElementById('apellidos').value = estudianteVerificado.apellidos || '';
            } else {
                info.style.display = 'block';
                info.innerHTML = '‚ùå NO HABILITADO';
                btn.disabled = true;
            }
        }

        function calcularEdad() {
            const fecha = new Date(document.getElementById('fecha_nacimiento').value);
            if (!fecha) return;
            const hoy = new Date();
            let edad = hoy.getFullYear() - fecha.getFullYear();
            if (hoy < new Date(hoy.getFullYear(), fecha.getMonth(), fecha.getDate())) edad--;
            document.getElementById('edad').value = edad + ' a√±os';
        }

        function irPaso2() {
            document.querySelectorAll('.form-step').forEach(el => el.classList.remove('active'));
            document.getElementById('step2-form').classList.add('active');
            document.getElementById('step1').classList.add('completed');
            document.getElementById('step2').classList.add('active');
        }

        function irPaso3() {
            const datos = {
                estudiante: {
                    cedula: document.getElementById('cedula_estudiante').value,
                    nombres: document.getElementById('nombres').value,
                    apellidos: document.getElementById('apellidos').value,
                    fechaNac: document.getElementById('fecha_nacimiento').value,
                    edad: document.getElementById('edad').value,
                    ano: document.getElementById('ano_cursar').value,
                    tipo: document.getElementById('tipo_ingreso').value
                },
                representante: {
                    nombres: document.getElementById('rep_nombres').value,
                    apellidos: document.getElementById('rep_apellidos').value,
                    cedula: document.getElementById('rep_cedula').value,
                    telefono: document.getElementById('rep_telefono').value,
                    email: document.getElementById('rep_email').value
                }
            };
            localStorage.setItem('inscripcionTemp', JSON.stringify(datos));
            mostrarResumen(datos);
            document.querySelectorAll('.form-step').forEach(el => el.classList.remove('active'));
            document.getElementById('step3-form').classList.add('active');
            document.getElementById('step2').classList.add('completed');
            document.getElementById('step3').classList.add('active');
        }

        function mostrarResumen(d) {
            document.getElementById('resumen-contenido').innerHTML = `
                <table class="resumen-table">
                    <tr><th colspan="2">üë®‚Äçüéì Estudiante</th></tr>
                    <tr><td>C√©dula</td><td>${d.estudiante.cedula}</td></tr>
                    <tr><td>Nombre</td><td>${d.estudiante.nombres} ${d.estudiante.apellidos}</td></tr>
                    <tr><td>Fecha nac.</td><td>${d.estudiante.fechaNac} (${d.estudiante.edad})</td></tr>
                    <tr><td>A√±o</td><td>${d.estudiante.ano}¬∞</td></tr>
                    <tr><th colspan="2">üë™ Representante</th></tr>
                    <tr><td>Nombre</td><td>${d.representante.nombres} ${d.representante.apellidos}</td></tr>
                    <tr><td>C√©dula</td><td>${d.representante.cedula}</td></tr>
                    <tr><td>Tel√©fono</td><td>${d.representante.telefono}</td></tr>
                    <tr><td>Email</td><td>${d.representante.email}</td></tr>
                </table>
            `;
        }

        function mostrarComprobante() {
            const input = document.getElementById('file-pago');
            archivoComprobante = input.files[0];
            const container = document.getElementById('file-info-container');
            if (archivoComprobante) {
                container.innerHTML = `
                    <div class="file-info">
                        <span>üìÑ ${archivoComprobante.name} (${(archivoComprobante.size / 1024).toFixed(1)} KB)</span>
                        <button onclick="eliminarComprobante()">üóëÔ∏è Eliminar</button>
                    </div>
                `;
            }
        }

        function eliminarComprobante() {
            document.getElementById('file-pago').value = '';
            archivoComprobante = null;
            document.getElementById('file-info-container').innerHTML = '';
        }

        function confirmarConPago() {
            if (!archivoComprobante) {
                alert('Debe subir un comprobante de pago para finalizar');
                return;
            }

            const datos = JSON.parse(localStorage.getItem('inscripcionTemp'));
            const numControl = 'INS-' + Date.now().toString().slice(-8);

            // PDF
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            doc.setFillColor(255, 243, 224);
            doc.rect(0, 0, 210, 297, 'F');
            doc.setFontSize(22);
            doc.setTextColor(255, 138, 92);
            doc.text('U.E. Colegio Los Andes', 20, 30);
            doc.setFontSize(12);
            doc.setTextColor(0, 0, 0);
            doc.text(`N¬∞ Control: ${numControl}`, 20, 50);
            doc.text(`Fecha: ${new Date().toLocaleDateString('es-VE')}`, 20, 60);
            doc.text(`Estudiante: ${datos.estudiante.nombres} ${datos.estudiante.apellidos}`, 20, 80);
            doc.text(`C√©dula: ${datos.estudiante.cedula}`, 20, 90);
            doc.text(`A√±o: ${datos.estudiante.ano}¬∞`, 20, 100);
            doc.text(`Representante: ${datos.representante.nombres} ${datos.representante.apellidos}`, 20, 120);
            doc.text(`Comprobante: ${archivoComprobante.name}`, 20, 140);
            doc.save('inscripcion-comprobante.pdf');

            alert(`‚úÖ Inscripci√≥n completada\nN√∫mero de control: ${numControl}\n\nRevise su correo para m√°s instrucciones.`);
            location.reload();
        }
    </script>
</body>
</html>